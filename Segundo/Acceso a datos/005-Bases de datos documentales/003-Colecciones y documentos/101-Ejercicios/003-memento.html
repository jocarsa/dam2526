<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memories Recorder</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            background-color: #f0f8ff;
        }
        .form-container {
            width: 300px;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            margin: 20px;
        }
        .form-container input,
        .form-container textarea,
        .form-container select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .form-container button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        .form-container button:hover {
            background-color: #45a049;
        }
        .stage {
            flex: 1;
            position: relative;
            background-color: #e6f2ff;
            border-radius: 10px;
            margin: 20px;
            overflow: hidden;
        }
        .bubble {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            padding: 15px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            max-width: 200px;
            word-wrap: break-word;
            animation: float 6s ease-in-out infinite;
        }
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h2>Nuevo Recuerdo</h2>
        <form id="memoryForm">
            <label for="vista">Vista:</label>
            <textarea id="vista" rows="2" required></textarea>

            <label for="momento">Momento:</label>
            <input type="date" id="momento" required>

            <label for="oido">O铆do:</label>
            <textarea id="oido" rows="2"></textarea>

            <label for="sentimos">Sentimos:</label>
            <textarea id="sentimos" rows="2"></textarea>

            <label for="olemos">Olemos:</label>
            <textarea id="olemos" rows="2"></textarea>

            <label for="sabor">Sabor:</label>
            <textarea id="sabor" rows="2"></textarea>

            <label for="palpamos">Palpamos:</label>
            <textarea id="palpamos" rows="2"></textarea>

            <label for="pensamos">Pensamos:</label>
            <textarea id="pensamos" rows="2"></textarea>

            <label for="ubicacion">Ubicaci贸n:</label>
            <input type="text" id="ubicacion" required>

            <button type="submit">Guardar Recuerdo</button>
        </form>
        <button id="recordButton"> Grabar Voz</button>
    </div>

    <div class="stage" id="stage">
        <!-- Las burbujas de recuerdos aparecer谩n aqu铆 -->
    </div>

    <script>
        // Grabaci贸n de voz
        const recordButton = document.getElementById('recordButton');
        let recognition;

        if ('webkitSpeechRecognition' in window) {
            recognition = new webkitSpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'es-ES';

            recordButton.addEventListener('click', () => {
                recognition.start();
                recordButton.textContent = ' Grabando...';
            });

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('oido').value = transcript;
                recordButton.textContent = ' Grabar Voz';
            };

            recognition.onerror = (event) => {
                console.error('Error en grabaci贸n:', event.error);
                recordButton.textContent = ' Grabar Voz';
            };
        } else {
            recordButton.style.display = 'none';
            alert('Tu navegador no soporta la grabaci贸n de voz.');
        }

        // Crear burbujas de recuerdos
        const memoryForm = document.getElementById('memoryForm');
        const stage = document.getElementById('stage');

        memoryForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const memory = {
                vista: document.getElementById('vista').value,
                momento: document.getElementById('momento').value,
                oido: document.getElementById('oido').value,
                sentimos: document.getElementById('sentimos').value,
                olemos: document.getElementById('olemos').value,
                sabor: document.getElementById('sabor').value,
                palpamos: document.getElementById('palpamos').value,
                pensamos: document.getElementById('pensamos').value,
                ubicacion: document.getElementById('ubicacion').value,
            };

            createBubble(memory);
            memoryForm.reset();
        });

        function createBubble(memory) {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';

            // Posici贸n aleatoria en el escenario
            const x = Math.random() * (stage.offsetWidth - 200);
            const y = Math.random() * (stage.offsetHeight - 200);
            bubble.style.left = `${x}px`;
            bubble.style.top = `${y}px`;

            // Contenido de la burbuja
            bubble.innerHTML = `
                <strong>${memory.ubicacion}</strong><br>
                ${memory.momento}<br>
                <small>${memory.vista}</small>
            `;

            // Agregar al escenario
            stage.appendChild(bubble);

            // L贸gica para agrupar burbujas por palabras clave
            setTimeout(() => {
                attractSimilarBubbles(bubble, memory);
            }, 100);
        }

        function attractSimilarBubbles(newBubble, newMemory) {
            const allBubbles = document.querySelectorAll('.bubble');
            const keywords = [
                newMemory.vista,
                newMemory.ubicacion,
                newMemory.sentimos,
                newMemory.pensamos
            ].filter(kw => kw.trim().length > 0);

            allBubbles.forEach(bubble => {
                if (bubble !== newBubble) {
                    const bubbleText = bubble.textContent.toLowerCase();
                    const hasSimilarKeyword = keywords.some(
                        kw => bubbleText.includes(kw.toLowerCase())
                    );

                    if (hasSimilarKeyword) {
                        // Mover burbujas similares m谩s cerca
                        const newX = parseFloat(newBubble.style.left);
                        const newY = parseFloat(newBubble.style.top);
                        const bubbleX = parseFloat(bubble.style.left);
                        const bubbleY = parseFloat(bubble.style.top);

                        const distance = Math.sqrt(
                            Math.pow(newX - bubbleX, 2) + Math.pow(newY - bubbleY, 2)
                        );

                        if (distance > 50) {
                            const angle = Math.atan2(newY - bubbleY, newX - bubbleX);
                            const moveX = Math.cos(angle) * 10;
                            const moveY = Math.sin(angle) * 10;

                            bubble.style.left = `${bubbleX + moveX}px`;
                            bubble.style.top = `${bubbleY + moveY}px`;
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>

